{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}{% trans "Utility scripts" %}{% endblock %}

{% block breadcrumbs %}
  <div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a> &rsaquo; {% trans 'Utility scripts' %}
  </div>
{% endblock %}

{% block content %}
  <h1>{% trans "Utility scripts" %}</h1>
  <p class="help">
    {% blocktrans %}Use these actions to execute scripts from <code>app-main/utils</code>. Output is shown as an admin message after the script finishes.{% endblocktrans %}
  </p>
  <p class="help">
    {% blocktrans %}Be cautiousâ€”many scripts interact directly with external systems or the production database.{% endblocktrans %}
  </p>
  <div class="module">
    <table class="admin-utility-table">
      <thead>
        <tr>
          <th scope="col">{% trans "Name" %}</th>
          <th scope="col">{% trans "File" %}</th>
          <th scope="col">{% trans "Description" %}</th>
          <th scope="col">{% trans "Run" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for script in scripts %}
          <tr>
            <th scope="row">{{ script.display_name }}</th>
            <td><code>{{ script.filename }}</code></td>
            <td>
              {% if script.doc %}
                <span class="script-doc">{{ script.doc|linebreaksbr }}</span>
              {% else %}
                <span class="quiet">{% trans "No description available." %}</span>
              {% endif %}
            </td>
            <td class="actions">
              <form method="post" action="{% url 'admin:run-utility-script' script.slug %}">
                {% csrf_token %}
                <button type="submit" class="button default">{% trans "Run" %}</button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="4" class="quiet">{% trans "No scripts were found in app-main/utils." %}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
